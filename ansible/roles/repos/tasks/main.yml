---
- name: Install required packages for HTTPS repositories
  apt: name={{ item.package }} state=present update_cache=yes cache_valid_time=3600
  become: yes
  with_items:
    - { package: apt-transport-https }
    - { package: ca-certificates }

- name: Install i3 repo gpg keyring package
  apt: deb=http://debian.sur5r.net/i3/pool/main/s/sur5r-keyring/sur5r-keyring_2017.01.02_all.deb
  become: yes

- name: Install PPA repositories
  apt_repository: repo={{ item.repo }}
  become: yes
  with_items:
    - { repo: "ppa:brightbox/ruby-ng" }
    - { repo: "ppa:gencfsm/ppa" }
    - { repo: "ppa:neovim-ppa/unstable" }
    - { repo: "ppa:numix/ppa" }
    - { repo: "ppa:gophers/archive" }
    - { repo: "ppa:git-core/ppa" }

- name: Install APT repository keys from keyserver
  apt_key: id={{ item.id }} keyserver={{ item.keyserver }} state=present
  become: yes
  with_items:
    - { id: "52E16F86FEE04B979B07E28DB02C46DF417A0893", keyserver: "packages.microsoft.com" }

- name: Install APT repository keys from URL
  apt_key: id={{ item.id }} url={{ item.url }} state=present
  become: yes
  with_items:
    - { id: "9DC858229FC7DD38854AE2D88D81803C0EBFCD88", url: "https://download.docker.com/linux/ubuntu/gpg" }
    - { id: "1B07204CD71B690D409F57D24ABE1AC7557BEFF9", url: "http://download.opensuse.org/repositories/isv:ownCloud:desktop/Ubuntu_{{ ubuntu_release_number }}/Release.key" }
    - { id: "6FEB6F83D48B93547E7DFEDEE019645248E8F4A1", url: "https://riot.im/packages/debian/repo-key.asc" }
    - { id: "B9F8D658297AF3EFC18D5CDFA2F683C52980AECF", url: "https://www.virtualbox.org/download/oracle_vbox_2016.asc" }
    - { id: "7B0FAB3A13B907435925D9C954422A4B98AB5139", url: "https://www.virtualbox.org/download/oracle_vbox.asc" }
    - { id: "72ECF46A56B4AD39C907BBB71646B01B86E50310", url: "https://raw.githubusercontent.com/yarnpkg/releases/gh-pages/debian/pubkey.gpg" }
    - { id: "DB085A08CA13B8ACB917E0F6D938EC0D038651BD", url: "https://packagecloud.io/slacktechnologies/slack/gpgkey" }
    - { id: "6084F3CF814B57C1CF12EFD515CF4D18AF4F7421", url: "http://apt.llvm.org/llvm-snapshot.gpg.key" }
    - { id: "9FD3B784BC1C6FC31A8A0A1C1655A0AB68576280", url: "https://deb.nodesource.com/gpgkey/nodesource.gpg.key" }
    - { id: "EB4C1BFD4F042F6DDDCCEC917721F63BD38B4796", url: "https://dl-ssl.google.com/linux/linux_signing_key.pub" }

- name: Install other repositories
  apt_repository: repo={{ item.repo }} state=present
  become: yes
  with_items:
    - { repo: "deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ubuntu_release }} stable" }
    - { repo: "deb http://debian.sur5r.net/i3/ {{ ubuntu_release }} universe" }
    - { repo: "deb http://download.opensuse.org/repositories/isv:/ownCloud:/desktop/Ubuntu_{{ ubuntu_release_number }}/ /" }
    - { repo: "deb https://riot.im/packages/debian/ {{ ubuntu_release }} main" }
    - { repo: "deb http://download.virtualbox.org/virtualbox/debian {{ ubuntu_release }} contrib" }
    - { repo: "deb https://dl.yarnpkg.com/debian/ stable main" }
    - { repo: "deb https://packagecloud.io/slacktechnologies/slack/debian/ jessie main" }
    - { repo: "deb http://apt.llvm.org/{{ ubuntu_release }}/ llvm-toolchain-{{ ubuntu_release }}-5.0 main" }
    - { repo: "deb https://deb.nodesource.com/node_8.x {{ ubuntu_release }} main" }
    - { repo: "deb [arch=amd64] https://packages.microsoft.com/repos/azure-cli/ wheezy main" }
