---
- name: Install i3 keyring
  apt:
    name: sur5r-keyring
    allow_unauthenticated: yes
    update_cache: yes
    cache_valid_time: 3600
    state: latest
  become: yes

- name: Install Debian packages
  apt:
    name: "{{ item.package }}"
    update_cache: yes
    cache_valid_time: 3600
    state: latest
    install_recommends: no
  become: yes
  with_items:
    - { package: "ruby2.4" }
    - { package: "ruby2.4-dev" }
    - { package: "git" }
    - { package: "i3" }
    - { package: "redshift-gtk" }
    - { package: "gnome-encfs-manager" }
    - { package: "gnome-terminal" }
    - { package: "autossh" }
    - { package: "compton" }
    - { package: "unclutter" }
    - { package: "urlscan" }
    - { package: "mutt" }
    - { package: "docker-engine" }
    - { package: "riot-web" }
    - { package: "numix-gtk-theme" }
    - { package: "numix-icon-theme" }
    - { package: "owncloud-client" }
    - { package: "feh" }
    - { package: "gnupg" }
    - { package: "transmission-gtk" }
    - { package: "neovim" }
    - { package: "unzip" }
    - { package: "dkms" }
    - { package: "virtualbox-5.1" }
    - { package: "pass" }
    - { package: "libdbus-glib-1-dev" }
    - { package: "whois" }
    - { package: "htop" }
    - { package: "mpv" }
    - { package: "i965-va-driver" }
    - { package: "vdpau-va-driver" }
    - { package: "golang-1.8" }
    - { package: "curl" }
    - { package: "jq" }
    - { package: "network-manager-openvpn-gnome" }
    - { package: "unrar" }

- stat:
    path: /usr/bin/google-chrome
  register: google

- name: Install Google Chrome
  apt: deb=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
  become: yes
  when: google.stat.exists == False

- name: Install Microsoft Core Fonts
  apt: deb=http://httpredir.debian.org/debian/pool/contrib/m/msttcorefonts/ttf-mscorefonts-installer_3.6_all.deb
  become: yes

- name: Remove Debian packages
  apt:
    name: "{{ item.package }}"
    purge: yes
    state: absent
  become: yes
  with_items:
    - { package: "thunderbird" }
    - { package: "pidgin" }

- name: Install Python packages
  pip:
    name: "{{ item.package }}"
    extra_args: --user
    state: latest
  with_items:
    - { package: "pip" }
    - { package: "setuptools" }
    - { package: "keyring" }
    - { package: "awscli" }
    - { package: "streamlink" }
    - { package: "neovim" }
    - { package: "secretstorage" }
    - { package: "dbus-python" }

- name: Install pip3
  apt:
    name: python3-pip
    update_cache: yes
    cache_valid_time: 3600
    state: latest
    install_recommends: no
  become: yes

- name: Install Python3 packages
  pip:
    name: "{{ item.package }}"
    extra_args: --user
    state: latest
    executable: /usr/bin/pip3
  with_items:
    - { package: "neovim" }

- name: Install Rubygems
  gem:
    name: "{{ item.package }}"
    user_install: no
  become: yes
  with_items:
    - { package: "bundler" }
    - { package: "neovim" }

- name: Install local Rubygems
  gem:
    name: "{{ item.package }}"
    user_install: yes
  with_items:
    - { package: "rubocop" }

- name: Install awstools
  get_url:
    url: https://github.com/sam701/awstools/releases/download/0.12.0/awstools_linux_amd64
    dest: "{{ ansible_env.HOME }}/.local/bin/awstools"
    sha256sum: bdfe603526b15de20356b03dee97159246bffda97d31512d61345ecd8d0222c8
    mode: 0755

- name: Ruby alternative
  become: yes
  alternatives:
    name: ruby
    path: /usr/bin/ruby2.4

- name: Gem alternative
  become: yes
  alternatives:
    name: gem
    path: /usr/bin/gem2.4

- name: vim alternative
  become: yes
  alternatives:
    name: vim
    path: /usr/bin/nvim

- name: pinentry alternative
  become: yes
  alternatives:
    name: pinentry
    path: /usr/bin/pinentry-curses

- include: hashicorp.yml
- include: docker.yml
- include: golang.yml
